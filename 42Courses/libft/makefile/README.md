## GNU make<br/>
<br/>
make는 프로그램의 소스 파일을 사용하여 실행 파일, 오브젝트 파일 등 소스 파일이 아닌 파일을 만드는 작업을 다루는 빌드툴이다.<br/>
make를 사용하면 반복적인 컴파일 혹은 셸 명령을 컴퓨터가 대신 자동으로 수행하게 만들 수 있다.<br/>
<br/>
#### make을 사용하는 이유<br/>
<br/>
일반적으로 리눅스 환경에서 gcc를 사용하여 소스 파일 하나를 실행 파일로 컴파일 할 때, 이하의 명령을 사용한다.<br/>
<br/>
gcc [소스 파일 이름] -o [실행 파일 이름]<br/>
<br/>
위와 같이 명령하면 컴파일러가 소스 파일의 내용을 기계어로 변환하여 실행파일을 작성해준다.<br/>
<br/><br/>
그런데, 만약 오브젝트 파일을 먼저 만든 뒤에 작업을 해야한다면 명령이 아래처럼 길어진다.<br/>
<br/>
gcc -c [소스 파일 이름]<br/>
gcc [오브젝트 파일 이름] -o [실행 파일 이름]<br/>
<br/>
이것 만으로도 작업이 2줄, 명령을 축약한다고 해도 직접 하나하나 입력하기엔 귀찮을 정도로 길어졌다.<br/>
<br/>
여기에 더해, 만약 소스 파일이 10개, 100개, 1000개가 넘어가고, 각 소스 파일에 대한 오브젝트 파일을 만들 필요성이 있다고 가정해보자.<br/>
대체 얼마나 길게 명령해야 각각의 오브젝트 파일을 만들고, 링크할 수 있을까?<br/>
<br/><br/>
이렇듯 작업해야하는 소스 파일이 많아지면 개발자의 작업 부담도 엄청나게 늘어나므로, 이를 자동화하여 컴퓨터가 대신 명령을 수행하게 만든 것이 make이다.<br/>
<br/><br/>
#### make의 구성<br/>
<br/>
make의 명령은 Target, Dependency, Recipe로 구성된다.<br/>
<br/><br/>
Target : Dependency<br/>
　　　　recipe<br/>
<br/><br/>
Target : 대상. 빌드의 결과로 만드려하는 목적 파일.<br/>
<br/>
Dependency : 의존성. 목적 파일을 구성하는 파일들의 관계. 의존성으로 지정된 파일이 변경되면 Target 명령을 다시 실행한다. (새 오브젝트를 만들거나, 링크하거나 등등)<br/>
<br/>
Recipe : 레시피, 명령. 목적 파일 빌드를 위해 실제로 실행되는 명령. 어떤 작업을 하는지에 따라 형태가 달라질 것이다.<br/>
<br/><br/>
makefile에 작성되는 명령은 위의 틀을 따른다.<br/>
위에서 보여준 예시를 여기에 적용한다면 이러한 형태가 될 것이다.<br/>
<br/>
[실행 파일 이름] : [오브젝트 파일 이름]<br/>
　　　　gcc [오브젝트 파일 이름] -o [실행 파일 이름]<br/>
<br/><br/>
위와 같이 makefile을 작성한 뒤 shell에서 make [실행 파일 이름]을 명령하면, recipe에 정의한 명령을 make가 shell에 직접 명령하게 된다.<br/>
<br/><br/>
여기에 더해 만약 소스 파일이나 목적 파일의 이름 등이 유동적이라면 Target 및 Dependency를 변수로 처리하고, 변수의 값을 대입하는 명령을 추가하는 등의 작업을 통해 recipe를 유지하면서 새로운 파일에 대한 대응도 할 수 있게 된다.<br/>
<br/>
TARGET = [실행 파일 이름]<br/>
SRCS = [소스 파일 이름]<br/>
CC = gcc<br/>
OBJTS = $(SRCS:.c=.o)<br/>
<br/>
$(TARGET) : $(OBJTS)<br/>
　　　　$(CC) $(OBJTS) -o $(TARGET)<br/>
<br/><br/>
이런 식으로 실제 작업을 하는 부분을 변수로 구성하고, 각 변수의 값을 지정해주는 것으로 나중에 소스 파일의 이름이 바뀌는 등의 의존성 변동이 발생했을 때, 변수를 수정하는 것만으로 컴파일 작업을 다시 수행할 수 있게 만들 수 있다.<br/>
<br/><br/>
여기서, OBJTS 변수가 SRCS 변수에 정의된 파일을 대상으로 무언가 작업을 하고 있는데, 이는 SRCS 변수에 정의된 파일 중 .c 파일들을 기반으로 .o (오브젝트) 파일을 생성하라는 명령이다.<br/>
<br/><br/>
makefile은 기본적으로 절차적으로 실행되며, 위에서부터 아래로 차례대로 make에 입력된 target을 찾아 내려온다.<br/>
<br/>
$(TARGET)<br/>
<br/>
그렇게 타겟을 찾아낸다면, 타겟의 종속성을 찾기 위해 다시 차례대로 변수를 탐색한다.<br/>
$(OBJTS)<br/>
<br/>
그리고 찾아낸 종속성에 해당하는 변수가 특정 작업을 수반하고 있을 경우, 이 작업을 먼저 수행하게 된다.<br/>
<br/>
OBJTS = $(SRCS:.c=.o)<br/>
<br/>
만약 SRCS에 정의된 .c 소스 파일의 갯수가 5개라면, OBJTS 의존성을 생성하기 위해 make는 모든 .c 파일을 대상으로 오브젝트 파일을 생성할 것이다.<br/>
그리고 그 모든 오브젝트 파일들이 TARGET의 종속성인 OBJTS가 되는 것이다.<br/>
<br/><br/>
